{"version":3,"sources":["../../../src/js/input-range/track.jsx"],"names":["Track","children","node","isRequired","classNames","objectOf","string","draggableTrack","bool","markers","arrayOf","shape","percentage","className","onTrackDrag","func","onTrackMouseDown","percentages","oneOfType","number","styles","props","trackDragEvent","markerRefs","state","markerWidths","setState","map","ref","offsetWidth","getBoundingClientRect","width","max","min","left","removeDocumentMouseMoveListener","ownerDocument","addEventListener","handleMouseMove","removeDocumentMouseUpListener","handleMouseUp","removeEventListener","event","clientX","touches","trackClientRect","getClientRect","position","x","y","addDocumentMouseMoveListener","addDocumentMouseUpListener","preventDefault","handleMouseDown","activeTrackLength","getActiveTrackStyle","trackStyle","track","activeTrack","activeTrackStyle","handleTouchStart","marker","idx","length","Math","round","push","markerSpan","class","textAlign","content","Component"],"mappings":"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","file":"track.js","sourcesContent":["import React from 'react';\nimport PropTypes from 'prop-types';\nimport autobind from 'autobind-decorator';\n\n/**\n * @ignore\n */\nexport default class Track extends React.Component {\n  /**\n   * @override\n   * @return {Object}\n   * @property {Function} children\n   * @property {Function} classNames\n   * @property {Boolean} draggableTrack\n   * @property {Function} onTrackDrag\n   * @property {Function} onTrackMouseDown\n   * @property {Function} percentages\n   */\n  static get propTypes() {\n    return {\n      children: PropTypes.node.isRequired,\n      classNames: PropTypes.objectOf(PropTypes.string).isRequired,\n      draggableTrack: PropTypes.bool,\n      markers: PropTypes.arrayOf(\n        PropTypes.shape({\n          percentage: PropTypes.string,\n          className: PropTypes.string,\n        }),\n      ),\n      onTrackDrag: PropTypes.func,\n      onTrackMouseDown: PropTypes.func.isRequired,\n      percentages: PropTypes.objectOf(\n        PropTypes.oneOfType([PropTypes.string, PropTypes.number]),\n      ).isRequired,\n      styles: PropTypes.objectOf(PropTypes.shape({})),\n    };\n  }\n\n  /**\n   * @param {Object} props\n   * @param {InputRangeClassNames} props.classNames\n   * @param {Boolean} props.draggableTrack\n   * @param {Function} props.onTrackDrag\n   * @param {Function} props.onTrackMouseDown\n   * @param {number} props.percentages\n   */\n  constructor(props) {\n    super(props);\n\n    /**\n     * @private\n     * @type {?Component}\n     */\n    this.node = null;\n    this.trackDragEvent = null;\n    this.markerRefs = [];\n\n    this.state = {\n      markerWidths: [],\n    };\n  }\n\n  componentDidMount() {\n    // eslint-disable-next-line react/no-did-mount-set-state\n    this.setState({\n      markerWidths: this.markerRefs.map(ref => ref.offsetWidth),\n    });\n  }\n\n  /**\n   * @private\n   * @return {ClientRect}\n   */\n  getClientRect() {\n    return this.node.getBoundingClientRect();\n  }\n\n  /**\n   * @private\n   * @return {Object} CSS styles\n   */\n  getActiveTrackStyle() {\n    const width = `${(this.props.percentages.max - this.props.percentages.min) *\n      100}%`;\n    const left = `${this.props.percentages.min * 100}%`;\n\n    return { left, width };\n  }\n\n  /**\n   * Listen to mousemove event\n   * @private\n   * @return {void}\n   */\n  addDocumentMouseMoveListener() {\n    this.removeDocumentMouseMoveListener();\n    this.node.ownerDocument.addEventListener('mousemove', this.handleMouseMove);\n  }\n\n  /**\n   * Listen to mouseup event\n   * @private\n   * @return {void}\n   */\n  addDocumentMouseUpListener() {\n    this.removeDocumentMouseUpListener();\n    this.node.ownerDocument.addEventListener('mouseup', this.handleMouseUp);\n  }\n\n  /**\n   * @private\n   * @return {void}\n   */\n  removeDocumentMouseMoveListener() {\n    this.node.ownerDocument.removeEventListener(\n      'mousemove',\n      this.handleMouseMove,\n    );\n  }\n\n  /**\n   * @private\n   * @return {void}\n   */\n  removeDocumentMouseUpListener() {\n    this.node.ownerDocument.removeEventListener('mouseup', this.handleMouseUp);\n  }\n\n  /**\n   * @private\n   * @param {SyntheticEvent} event\n   * @return {void}\n   */\n  @autobind\n  handleMouseMove(event) {\n    if (!this.props.draggableTrack) {\n      return;\n    }\n\n    if (this.trackDragEvent !== null) {\n      this.props.onTrackDrag(event, this.trackDragEvent);\n    }\n\n    this.trackDragEvent = event;\n  }\n\n  /**\n   * @private\n   * @return {void}\n   */\n  @autobind\n  handleMouseUp() {\n    if (!this.props.draggableTrack) {\n      return;\n    }\n\n    this.removeDocumentMouseMoveListener();\n    this.removeDocumentMouseUpListener();\n    this.trackDragEvent = null;\n  }\n\n  /**\n   * @private\n   * @param {SyntheticEvent} event - User event\n   */\n  @autobind\n  handleMouseDown(event) {\n    const clientX = event.touches ? event.touches[0].clientX : event.clientX;\n    const trackClientRect = this.getClientRect();\n    const position = {\n      x: clientX - trackClientRect.left,\n      y: 0,\n    };\n\n    this.props.onTrackMouseDown(event, position);\n\n    if (this.props.draggableTrack) {\n      this.addDocumentMouseMoveListener();\n      this.addDocumentMouseUpListener();\n    }\n  }\n\n  /**\n   * @private\n   * @param {SyntheticEvent} event - User event\n   */\n  @autobind\n  handleTouchStart(event) {\n    event.preventDefault();\n\n    this.handleMouseDown(event);\n  }\n\n  /**\n   * @override\n   * @return {JSX.Element}\n   */\n  render() {\n    const { markers } = this.props;\n    const activeTrackLength = this.getActiveTrackStyle();\n\n    const { track: trackStyle, track: activeTrack } = this.props.styles;\n\n    const { markerWidths } = this.state;\n\n    const activeTrackStyle = {\n      ...activeTrack,\n      ...activeTrackLength,\n    };\n\n    return (\n      <div\n        className={this.props.classNames.track}\n        style={trackStyle}\n        onMouseDown={this.handleMouseDown}\n        onTouchStart={this.handleTouchStart}\n        ref={(node) => {\n          this.node = node;\n        }}>\n        <div\n          style={activeTrackStyle}\n          className={this.props.classNames.activeTrack} />\n        {markers &&\n          markers.map((marker, idx) => {\n            let left = marker.percentage * 100;\n            if (markerWidths.length) {\n              left = `calc(${marker.percentage * 100}% - ${Math.round(\n                markerWidths[idx] / 2,\n              )}px)`;\n            }\n            return (\n              <span\n                key={marker.percentage}\n                ref={markerSpan => this.markerRefs.push(markerSpan)}\n                className={marker.class}\n                style={{\n                  position: 'absolute',\n                  left,\n                  textAlign: 'center',\n                }}>\n                {marker.content}\n              </span>\n            );\n          })}\n        {this.props.children}\n      </div>\n    );\n  }\n}\n"]}